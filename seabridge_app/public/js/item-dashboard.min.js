!function(){"use strict";
frappe.templates.item_dashboard='<div> <div class="dashboard-list-item">   <div class="row"><div class="col-sm-1 small" style="margin-top: 8px;"><center><input type="checkbox" id="chcb1" name="chcb1" class="chcb1"></center></div><div class="col-sm-2 small" style="margin-top: 8px;margin-left:-20px;"><b>Vendor</b></div><div class="col-sm-2 small" style="margin-top: 8px;margin-left:-20px;"><b>Inv#</b></div>  <div class="col-sm-1 small" style="margin-top: 8px;text-align:right;"><b>Inv$</b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;"><b> Budget </b></div><div class="col-sm-1 small" style="margin-top: 8px;">  <b>PO Date</b>  </div><div class="col-sm-1 small" style="margin-top: 8px;"> <b> Invoice Due Date </b> </div><div class="col-sm-1 small" style="margin-top: 8px;"> <a data-type="match"> <b> Match ? </b></a></div><div class="col-sm-1 small" style="margin-top: 8px;">  <b>Pending With  </b></div><div class="col-sm-1 small" style="margin-top: 8px;"><b>Status</b></div>   </div></div> <div class="result"></div>  <center><div id="records" class="records" style="font-size:90%;color:grey;"></div>  </center> <div id="btn-more" class="more"  style="padding: 15px;"> <a class="btn btn-default btn-xs btn-more">More</a>  </div> </div>  <center><table><tr><td><div class="submit"><button  id="btn-submit" class="btn btn-default btn-xs btn-submit  button-sbt button" style="display:none;margin-top: 20px;">Submit</a>    </div></td><td><div>&nbsp;<button id="btn-approve" class="btn btn-default btn-xs btn-approve button-apr button" style="display:none;">Approve</a>    </div></td><td><div>&nbsp;<button id="btn-reject" class="btn btn-default btn-xs btn-reject button btn-danger" style="display:none;">Reject</a>    </div></td></tr></center>',frappe.templates.item_dashboard_list='<style>input{border: none;background: transparent;}.button-sbt {background-color: #008CBA;}.button-apr {background-color: #4CAF50;}.button {border: none; color: white; padding: 6px 6px;text-align: center;font-size: 10px;margin: 2px 2px;}div.b {word-wrap: break-word;}.hover{cursor: pointer;margin: 15px 0;}</style>{% for d in data %}  <div class="dashboard-list-item">   <div class="row"> <div class="col-sm-1 small" style="margin-top: 8px;"><center>{%if (((d[4]=="Draft")||(d[4]=="Rejected") || (d[4]=="Debit Note Issued"))&&(d[10]=="1"||d[10]=="3"))%}<input type="checkbox" id="chcb2" name="chcb2" class="btn-check">{%else%}{%if ((d[4]=="Pending")&&(d[10]=="2"||d[10]=="3"))%}<input type="checkbox" id="chcb2" name="chcb2" class="btn-check">{%else%}<input type="checkbox" id="chcb2" name="chcb2" class="btn-check" disabled>{%endif%}{%endif%}</center></div>  <div class="col-sm-2 row-sm-3 small" style="margin-top: 8px;margin-left:-20px;word-wrap: break-word;">     <a data-type="supplier" data-name="{{ d.supplier }}">{{d[1]}}</a>   </div>    <div class="col-sm-2 small" style="margin-top: 8px;margin-left:-20px;">  <div style="color:blue;">       <label value="{{d[0]}}" style="color:blue;" id="inv" class="inv"><font style="color:blue;" class="hover">{{d[0]}}</font></label>{%if (d[12]>0)%}&nbsp;<i class="fa fa-paperclip" aria-hidden="true"></i>{%endif%} </div></div>  <div class="col-sm-1 small" style="margin-top: 8px;text-align:right;word-wrap: break-word;"> {{ d[2]}} </div> <div class="col-sm-1 small" style="margin-top: 8px;text-align:right;word-wrap: break-word;">  {{ d[9] }}  </div><div class="col-sm-1 small" style="margin-top: 8px;word-wrap: break-word;">  {{d[6]}}  </div> <div class="col-sm-1 small" style="margin-top: 8px;word-wrap: break-word;">  {{ d[3] }}  </div><div class="col-sm-1 small" style="margin-top: 8px;">  <a data-type="match">{%if d[7]==1%}Y{%else%}N{%endif%} </a> </div> <div class="col-sm-1 small" style="margin-top: 8px;word-wrap: break-word;">  {%if (d[14]==1) && (d[4]=="Pending")%} {{"SBTFX"}}{%else%} {{ d[8] }}{%endif%}</div><div name="{{d[1]}}" class="col-sm-1" style="margin-top: 8px;text-align:left;"> </a>         {%if (d[4]=="To Pay")%} <button id="btn-status" class="btn btn-default btn-xs btn-add btn-success btn-status" value="{{d[1]}}" style="background-color: #4CAF50;">{{d[4]}}</button>{%else%}{%if (d[4]=="Rejected")%} <button id="btn-status" class="btn btn-default btn-xs btn-add btn-danger btn-status" value="{{d[1]}}"style="background-color:#FF0000;">{{d[4]}} </button>{%else%}{%if (d[4]=="Draft")%} <button id="btn-status" class="btn btn-default btn-xs btn-info btn-status" value="{{d[1]}}" style="background-color:#8D99A6;">{{d[4]}}</button>{%else%}<button id="btn-status" class="btn btn-default btn-xs btn-add btn-warning btn-status" style="white-space: normal;" value="{{d[1]}}" style="background-color:#FFA00A;">{{d[4]}}</button> {%endif%} {%endif%} {%endif%}</div>    </div><div class="row"> <div class="col-sm-3 small"></div><div class="col-sm-9 small" style="margin-left:-40px;">{{d[13]}}</div></div></div> {% endfor %}',

frappe.provide("seabridge_app"),
seabridge_app.ActionTable=Class.extend({
    init:function(e){
        $.extend(this,e),this.make()
    },
make:function(){
var e=this;
function t(t,a){
}
	this.role=0
	this.start=0,
	this.sort_by||(this.sort_by="invoice_date",this.sort_order="desc"),
	this.content=$(frappe.render_template("item_dashboard")).appendTo(this.parent),this.result=this.content.find(".result"),
	this.content.on("click",".btn-move",function(){t($(this),"Move")}),
	this.content.on("click",".btn-add",function(){t($(this),"Add")}),
	this.content.on("click",".btn-submit",function(){
		document.getElementById("btn-submit").style.display="none";
		var allCB = document.querySelectorAll("input[id='chcb2']");
		var allInv = document.querySelectorAll("label[id='inv']");
		
		for(var i=0; i< allInv.length; i++){
			if(allCB[i].checked==true){
				frappe.call({method:"seabridge_app.seabridge_app.api.web_form",
				    async:false,
			    	    args:
			    	    {doc:allInv[i].textContent.trim(),
			    	   },
			    	    callback:function(r){
			    	    }
				})
			}
		    }
		window.location.reload();

	}),
	this.content.on("click",".lab-sts",function(){
		var vendor = jQuery(this).attr('value');
		get_paid_invoices(vendor)
	}),
	this.content.on("click",".btn-status",function(){
		var vendor = jQuery(this).attr('value');
		get_paid_invoices(vendor)
	}),
	this.content.on("click",".inv",function(){
		var invoice = jQuery(this).attr('value');
		frappe.call({method:"seabridge_app.seabridge_app.api.get_invoice_details",
			async:false,
			args:
			{invoice_name:invoice,
			},
			callback:function(r){
				var mockup_window=new frappe.ui.Dialog({title:__('<a href="desk#Form/Purchase%20Invoice/'+invoice+'" style="text-color:blue;" target="_blank"><div style="color:blue;">'+invoice+'</div></a>'),
					fields:[{fieldname:"company",label:__("Company"),fieldtype:"HTML",read_only:1},
						{fieldname:"description",label:__("Invoice Description"),fieldtype:"HTML",read_only:1},
						{fieldname:"po_date",label:__("PO Date"),fieldtype:"HTML",read_only:1},
						{fieldname:"po_qty",label:__("PO Qty"),fieldtype:"HTML",read_only:1},
						{fieldname:"inv_qty",label:__("Invoice Qty"),fieldtype:"HTML",read_only:1},
						{fieldname:"due_date",label:__("Invoice Date"),fieldtype:"HTML",read_only:1},
						{fieldname:"budget",label:__("Budget"),fieldtype:"HTML",read_only:1},
						{fieldname:"column_break",fieldtype:"Column Break"},
						{fieldname:"supplier",label:__("Vendor"),fieldtype:"HTML",read_only:1},
						{fieldname:"po_document",label:__("PO Document"),fieldtype:"HTML",read_only:1},
						{fieldname:"po_amount",label:__("PO$"),fieldtype:"HTML",read_only:1},
						{fieldname:"invoice_amount",label:__("Inv$"),fieldtype:"HTML",read_only:1},
						{fieldname:"net_amount",label:__("Net Amount"),fieldtype:"HTML",read_only:1},
						{fieldname:"tax_amount",label:__("Tax Amount"),fieldtype:"HTML",read_only:1},
						{fieldname:"receipt_required",label:__("receipt_required"),fieldtype:"HTML",read_only:1},
						{fieldname:"section_break",fieldtype:"Section Break"},
						{fieldname:"items",label:__("Items"),fieldtype:"HTML",read_only:1},
						{fieldname:"section_break",fieldtype:"Section Break"},
						{fieldname:"checklist",label:__("Attachment Checklist"),fieldtype:"HTML",read_only:1},
						{fieldname:"section_break",fieldtype:"Section Break"},
						{fieldname:"attachments",label:__("Attachments"),fieldtype:"HTML",read_only:1}
					]
				});
				mockup_window.show();
				var attachments=''
				for(var attachment=0; attachment<r.message[1].length; attachment++){
					attachments+='<a href="'+r.message[1][attachment][1]+'" Download><font style="color:blue;font-size: 12px;">'+r.message[1][attachment][0]+'</font></a><br>'
				}
				var po_doc='<font style="font-size: 12px;color:#9E9E9E;">PO Document</font><br><label style="background-color: #EDF2F2; color: blue;width: 260px;height: 29px;"><div style="color: blue;padding-top: 5px;padding-bottom:5px;padding-left: 9px;"></div></label>'
				if(r.message[0][0][4]){
				po_doc='<font style="font-size: 11px;color:#9E9E9E;">PO Document</font><br><label style="background-color: #EDF2F2; color: blue;width: 260px;"><a href="desk#Form/Purchase%20Order/'+r.message[0][0][4]+'" target="_blank"><div style="color: blue;padding-top: 5px;padding-bottom:5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][4]+'</div></a></label>'
				}
				var po_date='<font style="font-size: 12px;color:#9E9E9E;">PO Date</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;"></div></label>'
				if(r.message[0][0][6]){
				po_date='<font style="font-size: 11px;color:#9E9E9E;">PO Date</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][6]+'</div></label>'
				}
				var po_amount='<font style="font-size: 12px;color:#9E9E9E;">PO$</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;"></div></label>'
				if(r.message[0][0][5]){
				po_amount='<font style="font-size: 11px;color:#9E9E9E;">PO$</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][5]+'</div></label>'
				}
				var company='<font style="font-size: 12px;color:#9E9E9E;">Company</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][0]+'</div></label>'
				var vendor='<font style="font-size: 12px;color:#9E9E9E;">Vendor</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 12px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][1]+'</div></label>'
				var description='<font style="font-size: 12px;color:#9E9E9E;">Invoice Description</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;"></div></label>'
				if(r.message[0][0][8]){
					description='<font style="font-size: 12px;color:#9E9E9E;">Invoice Description</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][8]+'</div></label>'
				}
				var invoice_amount='<font style="font-size: 12px;color:#9E9E9E;">Inv$</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][3]+'</div></label>'
				var invoice_date='<font style="font-size: 12px;color:#9E9E9E;">Invoice Due Date</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][2]+'</div></label>'
				var budget='<font style="font-size: 12px;color:#9E9E9E;">Budget</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;"></div></label>'
				if(r.message[0][0][7]){
					budget='<font style="font-size: 12px;color:#9E9E9E;">Budget</font><br><label style="background-color: #EDF2F2; width: 260px;height: 29px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][7]+'</div></label>'
				}
				var items=''
				for(var item=0; item<r.message[0].length; item++){
					items+='<tr><td style="padding-left: 5px;font-size: 12px;">'+r.message[0][item][9]+'</td><td style="padding-right: 5px;text-align:right;font-size: 12px;">'+r.message[0][item][10]+'</td><td style="padding-right: 5px;text-align:right;font-size: 12px;">'+r.message[0][item][11]+'</td><td style="padding-right: 5px;text-align:right;font-size: 12px;">'+r.message[0][item][12]+'</td></tr>'			
				}
				var checklist=''
				for(var item=0; item<r.message[2].length; item++){
					checklist+='<tr><td style="padding-left: 5px;font-size: 12px;">'+r.message[2][item][0]+'</td><td style="padding-left: 5px;font-size: 12px;">'+r.message[2][item][1]+'</td><td style="padding-left: 5px;font-size: 12px;">'+r.message[2][item][2]+'</td></tr>'			
				}
				var net_amount='<font style="font-size: 12px;color:#9E9E9E;">Net Amount</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][13]+'</div></label>'
				var tax_amount='<font style="font-size: 12px;color:#9E9E9E;">Tax Amount</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][14]+'</div></label>'
				var po_qty='<font style="font-size: 12px;color:#9E9E9E;">PO Qty</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][17]+'</div></label>'
				var inv_qty='<font style="font-size: 12px;color:#9E9E9E;">Invoice Qty</font><br><label style="background-color: #EDF2F2; width: 260px;font-size: 16px;"><div style="padding-top: 5px;padding-bottom: 5px;padding-left: 9px;font-size: 12px;">'+r.message[0][0][16]+'</div></label>'
				if(r.message[0][0][15]==1){
				var receipt_required='<input type="checkbox" class="btn-check" disabled checked><font style="font-size: 12px;margin-left: 8px;">Receipt Required</font>'
				}
				else{
					var receipt_required='<input type="checkbox" class="btn-check" disabled><font style="font-size: 12px;margin-left: 8px;">Receipt Required</font>'
				}
				mockup_window.get_field("company").set_value(company)
				mockup_window.get_field("po_document").set_value(po_doc)
				mockup_window.get_field("po_amount").set_value(po_amount)
				mockup_window.get_field("due_date").set_value(invoice_date)
				mockup_window.get_field("supplier").set_value(vendor)
				mockup_window.get_field("po_date").set_value(po_date)
				mockup_window.get_field("invoice_amount").set_value(invoice_amount)	
				mockup_window.get_field("budget").set_value(budget)	
				mockup_window.get_field("description").set_value(description)
				mockup_window.get_field("net_amount").set_value(net_amount)
				mockup_window.get_field("tax_amount").set_value(tax_amount)
				mockup_window.get_field("inv_qty").set_value(inv_qty)
				mockup_window.get_field("po_qty").set_value(po_qty)
				mockup_window.get_field("receipt_required").set_value(receipt_required)
				mockup_window.get_field("items").set_value('<font style="font-size: 11px;color:#9E9E9E;">ITEM DETAILS</font><br><br><table width="100%" border="1" bordercolor="#BCB9B9"><tr bgcolor="#EDF2F2"><th style="padding-left: 5px;font-size: 12px;">Item</th><th style="padding-left: 5px;font-size: 12px;">Quantity</th><th style="padding-left: 5px;font-size: 12px;">Rate</th><th style="padding-left: 5px;font-size: 12px;">Amount</th></tr>'+items+'</table>')
				
				if(r.message[1]!=0){
					mockup_window.get_field("attachments").set_value('<font style="font-size: 11px;color:#9E9E9E;">ATTACHMENTS</font><br><br>'+attachments)
				}
				if(r.message[2]!=0){
					mockup_window.get_field("checklist").set_value('<font style="font-size: 11px;color:#9E9E9E;">ATTACHMENT CHECKLIST</font><br><br><table width="100%" border="1" bordercolor="#BCB9B9"><tr bgcolor="#EDF2F2"><th style="padding-left: 5px;font-size: 12px;">Description</th><th style="padding-left: 5px;font-size: 12px;">Mandatory</th><th style="padding-left: 5px;font-size: 12px;">Remarks</th></tr>'+checklist+'</table>')
				}
	   		}
		})
		
	}),
	this.content.on("click",".btn-approve",function(){
		document.getElementById("btn-approve").style.display="none";
		var allCB = document.querySelectorAll("input[id='chcb2']");
		var allInv = document.querySelectorAll("label[id='inv']");
		for(var i=0; i< allInv.length; i++){
			if(allCB[i].checked==true){
				frappe.call({method:"seabridge_app.seabridge_app.api.approve_invoice",
				    async:false,
			    	    args:
			    	    {doc:allInv[i].textContent.trim(),
			    	   },
			    	    callback:function(r){
			    	    }
				})
			}
			
		    }
		window.location.reload();

	}),
	this.content.on("click",".btn-reject",function(){
		var remarks_window=new frappe.ui.Dialog({title:__("To continue with rejection select the reason"),
	                    fields:[{fieldname:"remarks",label:__("Rejection Reason"),fieldtype:"Link",options:"Rejection Reason",reqd:1}
	                   ]});
		remarks_window.show();
		remarks_window.set_primary_action(__("Reject"),
		function(){
			var allCB = document.querySelectorAll("input[id='chcb2']");
			var allInv = document.querySelectorAll("label[id='inv']");
			reject_invoices(remarks_window.get_value("remarks"),allCB,allInv)
		})

	}),
	this.content.on("click",".btn-check",function(){
		var checked_val=0
		var allCB = document.querySelectorAll("input[id='chcb2']");
		for(var i=0; i< allCB.length; i++){
			if(allCB[i].checked==true){checked_val++}
		}
		if(checked_val==0){
			document.getElementById("btn-reject").style.display="none";
			document.getElementById("btn-approve").style.display="none";
			document.getElementById("btn-submit").style.display="none";
		
		}
		else
		{
			frappe.call({method:"seabridge_app.seabridge_app.api.get_user_roles_dashboard",
				    	    callback:function(r){
				    	  	this.role=r.message
						if(r.message==3 || r.message==1){
							document.getElementById("btn-submit").style.display="block";
				    	    	}
						if(r.message==3 || r.message==2){
							document.getElementById("btn-reject").style.display="block";
							document.getElementById("btn-approve").style.display="block";
						}
					}
			})
		}
	}),

	this.content.on("click",".chcb1",function(){
		if(chcb1.checked==1){
			var role=0
			var allCB = document.querySelectorAll("input[id='chcb2']");
			var allBut = document.querySelectorAll("button[id='btn-status']");
			frappe.call({method:"seabridge_app.seabridge_app.api.get_user_roles_dashboard",
				    async:false,
			    	    callback:function(r){
			    	  	this.role=r.message
					role=r.message
					
				}
			})
			var checked_count=0
			for(var i=0; i< allCB.length; i++){
				if(role==1){
				if((allBut[i].textContent=="Draft") || (allBut[i].textContent.trim()=="Rejected")){
					allCB[i].checked=true
				}}
				else if(role==2){
				if(allBut[i].textContent=="Pending"){
					allCB[i].checked=true
				}}
				if(allCB[i].checked==true){checked_count++}
			}
			if(checked_count>0){
				if(role==1){
					document.getElementById("btn-submit").style.display="block";
			    	}
				if(role==2){
					document.getElementById("btn-reject").style.display="block";
					document.getElementById("btn-approve").style.display="block";
				}

			}
		}
		else{
			var allCB = document.querySelectorAll("input[id='chcb2']");
			for(var i=0; i< allCB.length; i++){
				allCB[i].checked=false
			}
			document.getElementById("btn-reject").style.display="none";
			document.getElementById("btn-approve").style.display="none";
			document.getElementById("btn-submit").style.display="none";
		}
	}),
	
	this.content.find(".btn-more").on("click",function(){
	    e.start+=20,e.refresh()
	})
},
	refresh:function(){
	    this.before_refresh&&this.before_refresh();
	    var e=this;
	    var accounts_payable=0
	    frappe.call({method:"seabridge_app.seabridge_app.api.get_user_roles_dashboard",
				async:false,
				callback:function(r){
					if(r.message==2){
						accounts_payable=1
					}
				}
	    })
		if(accounts_payable==1){
			    frappe.call({method:"seabridge_app.seabridge_app.api.get_data",
		    	    args:
		    	    {name:this.purchase_invoice,
		    	    supplier:this.supplier,
		    	    match:this.match,
			    status:this.status,
			    company:this.company,
		    	    start:this.start,
		    	    sort_by:this.sort_by,
		    	    sort_order:this.sort_order},
		    	    callback:function(t){
		    	        e.render(t.message)
				if(t.message.length>0){
						if(parseInt(e.start+20)>parseInt(t.message[0][11])){
							document.getElementById("records").innerHTML = "Showing "+t.message[0][11]+" of "+t.message[0][11]+" records";
							document.getElementById("btn-more").style.display="none";
						}
						else{
							document.getElementById("records").innerHTML = "Showing "+(e.start+20)+" of "+t.message[0][11]+" records";
							document.getElementById("btn-more").style.display="block";
						}
					}
					else{
						document.getElementById("btn-more").style.display="none";
						document.getElementById("records").innerHTML = "Showing 0 of 0 records";
					}
		    	    }
			    })
			
		}
		else{
			frappe.call({method:"seabridge_app.seabridge_app.api.get_data",
		    	    args:
		    	    {name:this.purchase_invoice,
		    	    supplier:this.supplier,
		    	    match:this.match,
			    status:this.status,
			    company:'',
		    	    start:this.start,
		    	    sort_by:this.sort_by,
		    	    sort_order:this.sort_order},
		    	    callback:function(t){
		    	        e.render(t.message)
				if(t.message.length>0){
						if(parseInt(e.start+20)>parseInt(t.message[0][11])){
							document.getElementById("records").innerHTML = "Showing "+t.message[0][11]+" of "+t.message[0][11]+" records";
							document.getElementById("btn-more").style.display="none";
						}
						else{
							document.getElementById("records").innerHTML = "Showing "+(e.start+20)+" of "+t.message[0][11]+" records";
							document.getElementById("btn-more").style.display="block";
						}
					}
					else{
						document.getElementById("btn-more").style.display="none";
						document.getElementById("records").innerHTML = "Showing 0 of 0 records";
					}
		    	    }
			    })
		}
	},
	render:function(e){
	    0===this.start&&(this.max_count=0,this.result.empty());
	    var t=this.get_item_dashboard_data(e,this.max_count,!0);
	    if(this.max_count=this.max_count,e&&21===e.length?(this.content.find(".more").removeClass("hidden"),e.splice(-1)):1,t.data.length>0)
	    $(frappe.render_template("item_dashboard_list",t)).appendTo(this.result);
	    else{
	        var a=__("No further records available");
	        $("<span class='text-muted small'>  "+a+" </span>").appendTo(this.result)}},

	        get_item_dashboard_data:function(e,t,a){
	            t||(t=0),e||(e=[])
	            var r=0;
	            return frappe.boot.user.can_write.indexOf("Purchase Invoice")>=0&&(r=1),{
	                data:e,max_count:t,can_write:r,show_item:a||!1}
	            
	        }
	})
}();

function reject_invoices(reason,allCB,allInv){
	for(var i=0; i< allInv.length; i++){
			if(allCB[i].checked==true){
				frappe.call({method:"seabridge_app.seabridge_app.api.reject_invoice",
				    async:false,
			    	    args:
			    	    {doc:allInv[i].textContent.trim(),
				    remarks:reason
			    	   },
			    	    callback:function(r){
			    	       
			    	    }
				})
			}
			
		    }
	window.location.reload();


}

function get_paid_invoices(supplier){	
	selections=""
		 let dialogObj= new frappe.ui.form.MultiSelectDialog({
			 doctype: "Purchase Invoice",
			 target: this,
			 setters: {
			 grand_total:"",
			 due_date:"",
			 paid_date:""
			 },
			 date_field: "transaction_date",
			 get_query() {
			 return {
				 filters: {  docstatus: ['=', 1],supplier: ['=', supplier],status: ['=', 'Paid']}
				 }
			 },
			 action(selections) {
			}
	})
}

//# sourceMappingURL=item-dashboard.min.js.map
