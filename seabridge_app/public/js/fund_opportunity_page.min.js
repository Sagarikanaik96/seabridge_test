!function () {
	"use strict";
	frappe.templates.fund_dashboard = '<div> <div class="dashboard-list-item"> <h3 style= "padding-left: 30px;">Invoices Eligible For Funding</h3>  <div class="row"><div class="col-sm-1 small" style="margin-top: 8px;"><center></center></div></div> <div class="result"></div>  <center><div id="records" class="records" style="font-size:90%;color:grey;"></div>  </center> </div>  <center><table><tr><td><div class="submit"><button  id="btn-submit" class="btn btn-default btn-xs btn-submit  button-sbt button" style="display:none;margin-top: 20px;">Submit For Funding</a></div></td></tr></table></center>', frappe.templates.fund_dashboard_list = '<style>input{border: none;background: transparent;}.button-sbt {background-color: #008CBA;}.button-apr {background-color: #4CAF50;}.button {border: none; color: white; padding: 6px 6px;text-align: center;font-size: 10px;margin: 2px 2px;}div.b {word-wrap: break-word;}.hover{cursor: pointer;margin: 15px 0;}</style> {% for val in data %}<div class="dashboard-list-item"><div class="row"> <div class="col-sm-1 small" style="margin-top:8px;"><h5 style= "padding-left: 30px;"> Program:</h5></div><div class="col-sm-8 row-sm-3 small" style="margin-top: 8px;margin-left:-18px;text-align:left;"><h5 style= "padding-left: 30px;"> {{val.program_name}}</h5></div></div><div><div class="row"><div class="b"><div><div class="col-sm-1 small" style="margin-top: 8px;"><center><input type="checkbox" id="chcb1" name="chcb1" class="chcb1"></center></div><div class="col-sm-2 small" style="margin-top: 8px;text-align:left;"><b>Invoice Id</b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;"><b>Invoice Amount</b></div>  <div class="col-sm-1 small" style="margin-top: 8px;text-align:left;"><b>Invoice Date</b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:left;"><b> Due Date</b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;">  <b>Funding Amount</b>  </div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;"> <b> Transaction Fee </b> </div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;"> <b>Discount Charges </b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;"><b>Net Funding Amt</b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:right;">  <b>Balance On Due Date  </b></div><div class="col-sm-1 small" style="margin-top: 8px;text-align:left;"><b>Status</b></div> </div></div></div></div>{% for d in val.invoices %}{% if (((d.status==d.invoice_status)||(d.status=="NaN")) && (d.invoice_category=="AP")) %} <div> <div class="row"><div class="b">  <div class="col-sm-1 small" style="margin-top: 8px;"><center>{%if (d.invoice_status=="ELIGIBLE FOR FUNDING")%}<input type="checkbox" id="chcb2" name="chcb2" class="btn-check">{%else%}<input type="checkbox" id="chcb2" name="chcb2" class="btn-check"disabled>{%endif%}</center></div>  <div class="col-sm-2 row-sm-3 small" style="margin-top: 8px;text-align:left;" id="invoice_id" value={{d.invoice_id}}>{{d.orig_transaction_ref}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:right;"> {{d.amount_total}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;">{{d.invoice_date.split("-")[1].split("T")[0]}}-{{d.invoice_date.split("-")[1]}}-{{d.invoice_date.split("-")[0]}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:left;">{{d.due_date.split("-")[1].split("T")[0] }}-{{d.due_date.split("-")[1]}}-{{d.due_date.split("-")[0]}}</div><div class="col-sm-1 row-sm-3 small" id="funding_amount" style="margin-top: 8px;text-align:right;">{{d.funding_amount}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:right;">{{d.transaction_fee}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:right;">{{d.discount_charges}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:right;">{{d.net_funding_amount}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:right;">{{d.balance_on_due_date}}</div><div class="col-sm-1 row-sm-3 small" style="margin-top: 8px;text-align:left;">{{d.invoice_status}}</div></div></div>{% endif %}{% endfor %}</div></div> </div> {% endfor %}',



		frappe.provide("seabridge_app"),
		seabridge_app.ActionTable = Class.extend({
			init: function (e) {
				$.extend(this, e), this.make()
			},
			make: function () {
				var e = this;

				function t(t, a) {
				}
				this.role = 0
				this.today_claim=0
				this.start = 0,
					this.sort_by || (this.sort_by = "invoice_date", this.sort_order = "desc"),
					this.content = $(frappe.render_template("fund_dashboard")).appendTo(this.parent), this.result = this.content.find(".result"),
					this.content.on("click", ".btn-move", function () { t($(this), "Move") }),
					this.content.on("click", ".btn-submit", function () {  
						var allCB = document.querySelectorAll("input[id='chcb2']");
						var allInv = document.querySelectorAll("div[id='invoice_id']");
						for(var i=0; i< allCB.length; i++){
							if(allCB[i].checked==true){
							frappe.call({
								method: "seabridge_app.seabridge_app.api.fund_invoice",
								async: false,
								args: {
									invoice_id: jQuery(allInv[i]).attr('value')
								},
								callback: function (t) {
									//e.render(t.message)
								}
							})
							
							}
						}
						window.location.reload();
					}),
					this.content.on("click", ".btn-check", function () {
						var checked_val = 0
						var allCB = document.querySelectorAll("input[id='chcb2']");
						var allInv = document.querySelectorAll("div[id='funding_amount']");
						var funding_amount =0
						for(var i=0; i< allCB.length; i++){
							if(allCB[i].checked==true){
								funding_amount += parseFloat(allInv[i].textContent);
								checked_val++
							}
						}
       						$('div.todays-claims').text(funding_amount);
						if (checked_val == 0) {
							document.getElementById("btn-submit").style.display = "none";
						}
						else {
							document.getElementById("btn-submit").style.display = "block";
						}

					})
			},
	refresh: function () {
		this.before_refresh && this.before_refresh();
		var e = this;
		frappe.call({
			method: "seabridge_app.seabridge_app.api.get_programs",
			async: false,
			args: {
				status: this.status
			},
			callback: function (t) {
				e.render(t.message)
			}
		})
		
	},
render: function (e) {
	0 === this.start && (this.max_count = 0, this.result.empty());
	var t = this.get_item_dashboard_data(e, this.max_count, !0);
	if (this.max_count = this.max_count, e && 21 === e.length ? (this.content.find(".more").removeClass("hidden"), e.splice(-1)) : 1, t.data.length > 0)
		$(frappe.render_template("fund_dashboard_list", t)).appendTo(this.result);
	else {
		var a = __("No further records available");
		$("<span class='text-muted small' style='padding-left: 30px;'>  " + a + " </span>").appendTo(this.result)
	}
},

get_item_dashboard_data: function (e, t, a) {
	t || (t = 0), e || (e = [])
	var r = 0;
	return frappe.boot.user.can_write.indexOf("Invoice") >= 0 && (r = 1), {
		data: e, max_count: t, can_write: r, show_item: a || !1
	}

}
		})
}();

//# sourceMappingURL=item-dashboard.min.js.map
